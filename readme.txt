Сборка Far Manager UE3 (Far UE3, FarUE3) х86

Общее описание:

Сборка задумана как универсальный инструмент для ИТ инженера, а потому она
может использоваться и как устанавливаемый, и как портабельный вариант. Я
специально ограничил состав включённых в неё плагинов только теми которые
нужны для восстановления работы ОС при сбоях и её настройки, а если нам
потребуются иные функции есть Lua-скрипты и встроенная поддержка языка
MoonScript (описание языка прилагается).

Формат командной строки плагина LuaMacro для b3879 r11721 и выше:

       lm:    load
       lm:    save
       lm:    unload
       lm:    user
       lua:   <sequence> | @<filename> [<params>]
       moon:  <sequence> | @<filename> [<params>]
       macro: user

где <sequence>  - Lua или MoonScript выражение. Старый синтаксис командной
строки для запуска Lua скриптов "lm:post (macro:post) <sequence>" удалён!

По умолчанию автосохранение настроек выключено, что позволяет работать
с носителей с ограниченным ресурсом перезаписи (USB-Flash, CD/DVD-RW...).
Для сохранения своих настроек используйте комбинацию клавиш Shift+F9.

При запуске сборки автоматически выставляется размер окна 80x35 и шрифт
Lucida Console,15 (15pt). Если вы указали запуск в полноэкранном режиме
консоли будет выставлен только шрифт, а размер окна не изменится. Это
обеспечивается Lua-скриптом "Common_ConsControl.lua" в который встроена
необходимая автоматика. Поменять значения по умолчанию вы можете
отредактировав скрипт в строках 15 - 17 и 21 не трогая команды плагина:

     ...,"WindowSize",<ширина, знаков>,<высота, знаков>
     ...,"BufferSize",<ширина, знаков>,<высота, знаков>
     ...,"FontName","<имя шрифта>",<размер шрифта>

Оба макроса входящие в скрипт независимы, так что меняя указанные значения
трудно что-то сломать. Только логику скрипта не трогайте или дров наломаете
(в сборке есть необходимый для него модуль ConsoleControl.lua).

Минимальные системные требования:

 Windows XP/2003 SP3 x64 и выше (на ядре Windows 5.1/5.2 функциональность
 набора ограничена WinAPI), примерно 150 Мб места на диске, пользователь
 должен иметь права записи в каталог данной копии Far3 (настройки хранятся в
 локальной БД), процессор Intel Pentium D/AMD64 или аналогичный с наборами
 инструкций SSE2/3, ("спасибы" в Микрософт за VC++201х - он эти команды молча
 в код вставляет), для запуска требуется до 100 Мб оперативной памяти.

 Для работы модуля Observer::VDISK и утилиты DelEmptyFolder.exe необходимо
 наличие установленного MS .NET Framework 4.0 (иначе они не запустятся), для
 иных модулей из состава сборки .NET Framework не требуется.

 OpenSSL Toolkit v1.1.1c и новее.

 Perl v5.24/5.26 (в 5.28 наделали ошибок) для работы конверторов Markdown в
 BB-code и/или HTML.

Запуск PORTABLE редакции осуществляется через через утилиту hidcon которая
вызовет скрытый консольный процесс скрипта rfar.cmd, а тот если они есть
подчистит следы аварийного завершения предыдущей сессии FarUE3 и вызовет как
новую задачу Far.exe с установкой нужных для оставшихся ANSI плагинов FarTray
и MultiArc значений в Реестре и завершится.

Для устанавливаемой редакции применяется обычная схема запуска через ярлык.

Надо вам запустить из одной копии Far другую? Нет проблем - выдайте из
комстроки Far команду: "@start /i .\Far.exe" и Far запустится в новой
независимой консоли и не будет мешать текущей копии, хотя истории и изменения
настроек все запущенные копии будут разделять между собой через БД в профиле.

Данная схема запуска позволяет запускать несколько копий Far как независимые
консольные задачи с исключением их взаимовлияния путём передачи переменных
окружения от задачи-родителя к задаче-потомку - новая задача автоматически
получит набор переменных окружения заданный по умолчанию для консольной
сессии в данной копии ОС.

В случае сбоя профиля что видно по проблемам с запуском или при выходе из Far
попробуйте сбросить его настройки с помощью скрипта recover.cmd расположенном
в каталоге куда установлена сборка.

ВНИМАНИЕ!

При запуске recovery.cmd все внесенные вами в настройки сборки изменения, ваши
фильтры и истории будут удалены, а настройки сброшены к умолчаниям заданным в
default.farconfig.

Настоятельно не рекомендуется что либо менять в нём если вы не знаете что это
за параметр и как его изменение отразится на стабильности работы сборки!

Поскольку recovery.cmd это скрипт для восстановления работоспособности FarUE3,
все диагностические сообщения в нём по умолчанию включены.

ВНИМАНИЕ!

Некоторые антивирусы реагируют на hidcon-x32.exe как на потенциальную угрозу
Особенно этим славен Symantec - для него это Symantec WS.Reputation.1 и с 2012
года компания не удосужилась перепроверить "оценку" данную её пользователями,
но поскольку сия мухобойка отличается редкими "странностями" (у меня она в
своё время молча удалила в сети исходники ядра BSD UNIX - "Микрософт утверждает
что UNIX это вирус, а в порядочной сети кроме Windows ничего вообще быть не
должно!") то сами умеряйте паранойю сей мухобойки, для проверки что у вас
оригинальная копия файла hidcon-x32.exe проверьте его SHA-256:

SHA-256: 693485f0a3fe5a2ccbf875625cdc8ece2988442ac70c60f2e130d01559e7a891

необходимости пересобирать hidcon-x32.exe в другом компиляторе из-за одной
мухобойки я не вижу - они всё одно её снова добавят в свои базы.:)

Программа установки по умолчанию устанавливает сборку на локальный диск, при
этом все настройки, фильтры, кэш плагинов и истории хранятся в подкаталоге
.\Profile сборки, а так же создаются ярлыки в меню Пуск и на общем Рабочем
столе. Если на странице выбора компонент инсталлятора отмечен флажок "Install
as portable" то сборка будет установлена в особом режиме для работы со
сменного носителя (PORTABLE). При этом программа удаления, записи Реестра и
ярлыки не создаются, а все настройки, кэши и истории хранятся в каталоге
.\Profile и обновить её средствами штатной утилиты farue3-update.exe
невозможно, только поставить новую версию поверх текущей.

Выбранная схема хранения настроек требует наличие у пользователя прав записи в
%FARHOME%\Profile (при необходимости отредактируйте его ACL или ставьте сборку
в тот каталог где у вас есть такие права и не забудьте отключить индексацию
%FARHOME%\Profile средствами ОС иначе плагины не могут записать свои настройки
что приводит к падению Far.

В архиве может присутствовать модуль farue3-update.exe - штатная утилита
обновления для обычной установки.

За все неудобства скажите "спасибо" админам YandexDisk которые под надуманным
предлогом заблокировали мои документы после чего резко возрос объём спама в
моём п/я. До блокировки было отмечено 41 и 43 случая скачивания запороленных
документов до того как мои коллеги получили на них ссылки и на вопрос что это
админы ЯД отвечать отказались, но потребовали предоставления им всех моих
личных данных для передачи третьим лицам.

Система обновлений подходит только для STANDALONE копий FarUE3 и начиная с
билда указанного в элементе "Название продукта" свойств исполняемого модуля и
построена на учёте ревизий в репозитории исходников Far Manager.

К примеру если мы в названии продукта видим запись:

   Far Manager UE3 Update для b5081  (рус.)
   Far Manager UE3 Update for b5081  (анг.)

сообщающую нам что данное обновление подходит для выпусков от b5081 и новее,
то в начиная с этой сборки обновления позволяют обновить установленную у вас
копию до последней версии.

Нумерация версий пакета установки:

Используем BSD систему нумерации (как принято для FreeBSD UNIX):

  J.M.B.R-V где:

  J - старшая цифра версии, меняется при внесении принципиальных изменений в
      алгоритм Установки;
  M - младшая цифра версии,  меняется при смене серии алгоритмов;
  B - билд алгоритма, меняется при изменении алгоритма в пределах серии;
  R - ревизия, меняется при внесении мелких изменений в алгоритм, например файл
      добавился или удалён, но общая логика алгоритма не изменилась;
  V - вариант сборки, логика не менялась, но были обновлены отдельные файлы.
      Меняется только если не обновлялись исходники Far. При их обновлении
      сбрасывается в 1.

Добавлено начиная с b5171 Git-c224fa8f5:

Поле версии продукта для программ Setup, Addon и Update содержит новмер версии
в виде:

M.J bB Git-H, где:

    M.J - старшие цифры версии Far Manager (Minor.Major)
    B - номер билда Far Manager на котором основана текущая версия FarUE3
    H - хэш коммита исходников Far Manager из которых собрана данная
        версия FarUE3.

Эта информация не используется системой обновления и приводится только для
справки.

ВНИМАНИЕ!

При своём запуске программа установки автоматически закроет все запущенные
копии Far, а потому желательно заранее сохранить в них данные ибо ОС закроет
все процессы с именем Far.exe.

Программа установки имеет механизм предотвращения некоторых ошибок локали,
в частности если язык ядра вашей копии ОС отличается от русского, то для Far и
программы установки принудительно выставляется английский язык, но возможность
выбора русского языка для Far остаётся доступной в его настройках.

Мини FAQ:

Общее:

Q:  Почему при включённой опции "Use system copy routine" в процессе копирования
    файлов общее число байт меняется несколько раз?

A:  На этот вопрос в Mantis#0003119 ответил DrKnS:
    "Всё именно так и должно быть.
     При [x] Use system copy routine копируются дополнительные потоки.
     При предварительной оценке копируемого объёма они не учитываются (иначе
     будет тормозить), при обнаружении такого потока уже в процессе
     копирования суммарный объем корректируется, чтобы в итоге не получилось
     больше ста процентов.".

Q: Где хранятся ссылки на папки (Far3)?

A: В файле %FARLOCALPROFILE%\shortcuts.db.

Q: Входящий в сборку Wget выводит сообщения только на английском языке. Почему?

A: В сборке использован официальный Win32/64 порт Wget (от Jernej Simoncc)
   собираемый без поддержки i18n, но имеющий поддержку OpenSSL/WinSSL
   (MultiSSL) и регулярных выражений POSIX/PCRE. Поддержка i18n есть в сборках
   от TumaGonx Zakkum (osspack32, The Moluccas) где вместо OpenSSL использована
   неизвестная версия библиотеки GnuTLS  обозначенная как 3.14.17 (на сайте
   проекта GNU такой версии нет, и скорее всего речь идёт об устаревшей версии
   3.0.14 от 24.02.2012, а т.к. запуск его последних сборок часто завершается
   аварийно (AV) они были заменены на en-US стабильные официальные сборки.

Q: Почему возникает ошибка при подсчёте размера каталогов?

A: На самом деле ошибки нет, Far правильно выводит размер, но если наш каталог
   содержит жёсткие и/или символьные ссылки либо является точкой монтирования,
   то у вас может сложится впечатление что подсчёт ошибочен, хотя ошибки нет
   поскольку не все файлы которые вы видите в каталоге реально находятся в
   нём - Файлы на которые указывают символьные/жёсткие на деле находятся вне
   каталога, а в нём только числятся для удобства использования. Да и путаница
   аббревиатур даст ошибку в оценке т.к. в ВТ исторически используются системы
   счисления с основанием 2, и 1Gb=1024^3=1073741824, но многие "округляют"
   его до 1 GiB=10^9=1000000000, и пишут 1Gb=1GiB вроде и разница всего-то
   проценты с хвостиком, да и от подмены понятий вроде и смысл слегка меняется…

   И отсюда кстати вопросы типа заданного в mantis#0002570:

     "И с единицами измерения не всё хорошо.
      В википедии встречаются такие обозначения:
      2^30 - "Гбайт"/"GiB"
      10^9 - "ГБ"/"GB""

   - авторы и корректоры ВИКИ-статей часто путают метрическую систему СИ с
   основанием 10^n и двоичную систему с основанием 2^k в аббревиатурах которых
   согласно международным стандартам присутствует указатель на основание
   системы счисления - для единиц СИ аббревиатура единиц измерения начиная с
   10^3=1K это три буквы вторая из которых обязательно строчная "i"
   указывающая на десятичные единицы измерения системы СИ, для двоичной
   системы она отсутствует, а обозначения вида 1GB и 1Gb по смыслу
   равноправны, просто не рекомендуется смешивать регистр символов в пределах
   одного текста, но это уже правила стилистики подавляющего большинства
   языков, а для них это мелочь.

Q: Откуда читается список расширений исполняемых файлов для их использования
   в ассоциациях Far b4723 и новее?

A: Far читает этот список из переменной среды %PATHEXT%.

Q: Какие символы нельзя использовать в именах файлов NTFS?

А. Согласно официальному ответу Микрософт в конференции MSDN имена файлов не
   должны содержать следующие символы:

      Звёздочка  (*)
      Вертикальная черта  (|)
      Обратная косая черта  (\)
      Двоеточие  (:)
      Двойные кавычки  (").
      Меньше  (<)
      Больше  (>)
      Вопросительный знак  (?)
      Косая черта  (/)

   поскольку они имеют служебное применение в файловой системе NTFS. Также
   любые имена файлов или пути содержащие знаки "пробел" при их задании в
   командной строке должны заключаться в двойные кавычки ("имя файла|путь
   содержащие пробелы").

Q: Можно ли создать относительные симлинки на NTFS и какая версия сборки это
   может сделать?

A: Да, можно, но относительные симлинки могут быть созданы только в пределах
   одного тома командой AltShiftF6 и в диалоге "Create link" надо снять
   флажок "Absolute Path". Эта возможность доступна в сборке b3920 и выше.

Q. Цвет объекта под курсором меняется на светло-голубой или красный. Что это
   такое и зачем это сделано?

A. Это сделано для индикации файловых атрибутов NTFS. Светло-голубой цвет
   обозначает "Сжатый" (С+) файл или каталог, а красный указывает на особый
   объект файловой системы NTFS - "Точка повторного анализа (Точка повторной
   обработки)" (частично поддерживается в ReFS) (L+) - такой файл или каталог
   содержит специальные данные ("Reparse Points Data") с помощью которых в
   NTFS    реализуются символьные ссылки (symlink), символьные связи (junction
   point) и пользовательские типы точек повторного анализа (для этого вам надо
   установить пользовательские драйвера фильтров файловой системы которые
   обеспечивают обработку содержащихся в них "Reparse Data").

   Примечание:

   Наличие у файла или каталога "жёстких связей" (hardlinks) NTFS (в ReFS на
   2016 год механизм hardlinks не реализован) раскраской не индицируется, но
   их число можно увидеть в колонке "КлС" режима панели файлов "Ссылки файлов"
   (Ctrl-9). Это сделано специально, т.к. hardlinks могут быть у любого файла
   или каталога кроме Reparse Points (см. описание Reparse Points на MSDN).

Q. Что означают символы "/" и "!" перед именем файла (каталога) и его цвет?

A. Символ "/" обозначает каталог, красный "/" обозначает симлинк на каталог,
   красный "!" - симлинк на файл (как в UNIX). Цвет файла или каталога
   указывает состояние NTFS атрибута Compressed - светло-голубой "Сжатый",
   белый нет. Остальные цвета стандартные.

Q: Можно ли запустить из редактора URL поставив на него курсор?

A: Да, можно, поставив курсор в нужное место и нажав клавиши "CtrlEnter" или
   "CtrlNumEnter". Скрипт работает как с URL, так и с UNC путями и при запуске
   запрашивает подтверждение операции. Вы можете отключить запрос сами
   сконфигурировав скрипт. Я специально не говорю как это сделать - опытные
   пользователи кто знаком с Lua и сам поймёт о чём речь, а новички не сделают
   лишних ошибок. Это страховка для них.

A: Будут ли работать UNC пути в стиле UNIX?

Q: В b4423 и старше - да, раньше - нет.

   Ограничение: UNC пути в стиле UNIX применимы только для команд OC
   реализованных в Far, панелей, вызовов far -e/-v т.е. в тех случаях
   когда не вызывается CMD.

A: Как можно посмотреть информацию о версии исполняемых файлов?

Q: Или через плагин filever (хоткей CtrlAltV), но он не работает (падает) если
   вы попробуете опросить файлы OS/2 PM (16-битные исполняемые файлы OS/2
   v1.1.x). Для исполняемых файлов формата РЕ (Win32/64) ограничений нет.
   Плагин считывает информацию из структуры VERSION_INFO, но ЭЦП не проверяет.
   Это задача оболочки ОС. Также можно посмотреть версию файла через плагин
   "NTFS File Information" (имя файла писать без пробела после префикса!):

     nfv:<filename>

   Или используя режимы 4 и 5 файловой панели (хоткеи Ctrl4 и Ctrl5) в колонке
   "ver". Информация выводится в виде пары "Платформа" "Версия", где:

   Платформа: [x32], [x64], [IA64], [xDN] (для модулей .Net), [dos], [win].

     Если вместо "x32/х64" показано "s32/s64" то, это значит что данный PE-файл
     имеет цифровую подпись, но её валидность не проверяется.

   Версия: строковые значения из стандартного ресурса VERSION_INFO.

Q: Можно ли использовать Far c другими командными оболочками кроме CMD?

A: Да, в b4720 и новее это настраивается через far:config в разделе System:

   System.Executor.Comspec - имя командного процессора
   ystem.Executor.ComspecArguments - список аргументов для его вызова
   System.Executor.ComspecCondition - определяет условия (в т.ч. регексп) при
   выполнении которых комстрока передаётся командному процессору.

Q: Что показывают параметры "Виртуальная (всего)" и "Виртуальная (свободно)" в
   секции "Память" панели "Информация" (Ctrl-L) и почему там отображаются
   значения большие чем сумма размера установленного ОЗУ и файла подкачки?

A: Это объём адресуемой ОС виртуальной памяти зависящий от её архитектуры и
  режима работы. Его величина может не совпадать с максимальным объёмом
  адресуемой ЦП виртуальной памяти.

Q. Почему для x86 сборки FarUE3 есть инсталлятор и программа обновления, а
   для х64 их нет?

A. Для х64 инсталлятор не нужен т.к. он портабелен "из коробки" - хранит
   настройки в своём каталоге и после разархивирования на рабочий носитель
   готов немедленно к работе, а х86 использует инсталлятор т.к. хранит ряд
   настроек в Реестре, а часть из них формируется установщиком "по месту".

Запуск и решение типовых проблем:

Q: Что делать если предыдущая сессия работы Far завершилась аварийно?

A: В таком случае просто запустите сборку через ярлык Recovery settings (или
   скрипт "recover.cmd") но время запуска будет больше т.к. происходит очистка
   БД конфигурации и кэш плагинов создаётся заново.

Q: Мне нужно запустить Far так, чтобы на панелях были разные каталоги?

A: Стартовый скрипт умеет передавать Far два параметра - Ldir и Rdir, но если
   имя каталога заданного в качестве параметра заканчивается "\", то он должен
   быть удвоен, а имя каталога в параметре передано в кавычках.

Q: Windows 10 RS1 14371.0 - в консоли у фара пропала прокрутка колесом мыши
   что делать?

A: Одно из решений использовать макрос, например такой:

   Macro{
     uid="D7D3F2E7-A66D-44A7-B513-F67BE9A165B2";
     area="Common";
     key="MsWheelUp";
     description="MsWheel scroll for Windows 10 RS1 14371.0 Up";
     priority=50;
     sortpriority=50;
     action=function() Keys("Up") end;
   }

   Macro{
     uid="E91915A1-4ED5-4FD7-A629-B73C59F6DDFF";
     area="Common";
     key="MsWheelDown";
     description="MsWheel scroll for Windows 10 RS1 14371.0 Dowm";
     priority=50;
     sortpriority=50;
     action=function() Keys("Down") end;
   }

   Сохраните его в файл, например "Common_MsWheelScroll.lua" с кодировкой
   UTF-8 и положите в каталог ./Profile/Macros/scripts , альтернатива
   написать свой макрос/плагин или ждать милости от M$. В сборке такого
   скрипта-примера в готовом виде нет ибо прост, а кому надо и сам напишет.

Q: Как выйти из консоли коли она "зависла" (т.е. запущенное в ней приложение
   долго не отвечает или не реагирует на команды)?

A: По умолчанию CtrlShiftTab или посмотреть какая комбинация клавиш задана в
   настройке far:settings -> System.ConsoleDetachKey.

Q: При запуске появляется окно с предложением перенести настройки. Что это
   такое и зачем нужно?

A: Это окно выводит утилита LMDataMove если у вас обнаружены старые пути к
   настройкам  скриптов от IgorZ. Чтобы это окно не появлялось стоит нажать
   Move, но если у вас стоят и старые новые версии этих скриптов вы можете
   выбрать Copy, но даже сам Игорь не уверен в том, что новые версии скриптов
   будут совместимы по настройкам со старыми и смогут считать их по старым
   адресам.

   После того как все настройки будут перенесены в новое место это окно для
   текущего пользователя более не появится. И хотя достаточно исправить всего
   одну строку в теле утилиты чтобы она автоматически перемещала данные я не
   уверен в том, что в этом есть смысл так я не могу заранее знать какие
   именно версии скриптов у вас установлены. Утилита переносит настройки
   скриптов BookmarkManager, CtrlAltMenuDisk, EnvManager и LuaManager в новый
   подраздел БД LuaMacro. Я могу убрать её запрос, но это может привести к
   ошибкам и поэтому пока он оставлен, а после я планирую её саму убрать.

Q: Нужны ли мне какие-то опциональные подстройки и если да, то какие?

A: Да, если вы ставите сборку не в %ProgramFiles% (%ProgramFiles(x86)% для
   64-х битных ОС) или при сбоях DBEdit/LuaManager вам придётся вручную
   подстроить пути поиска скриптов и модулей в настройках LuaManager через
   подменю настройки конфигурации плагинов (F9 - Параметры - Параметры
   плагинов - Менеджер Lua/Moon скриптов - Фильтр путей поиска). В этом
   диалоге отметьте (Space) только пути вида:

         %FARHOME%\Profile\Macros\modules\?.lua
         %FARHOME%\Profile\Macros\modules\?\init.lua
         %FARHOME%\Profile\Macros\modules\?.moon
         %FARHOME%\Profile\Macros\modules\?\init.moon

   а остальные пометки снимите, закройте этот диалог по Enter и нажмите
   Сохранить, затем ShiftF9 для записи настроек в БД.

   Примечание:

   Иногда такая подстройка может потребоваться и для портативной редакции.

Плагины:

Q: Как управлять плагинами?

A: Для этого в сборке есть вызываемый по "F11" модуль управления плагинами
   который имеет несколько "секретов":

     Del - выгрузить отмеченный плагин
     Ins - загрузить плагин выбрав его из списка выгруженных по Ctrl+H
     Ctrl+H показать/скрыть список плагинов

Q: Как узнать GUID плагина?

A: Нажмите на его имени в списке плагинов F3

Q: Можно ли использовать в Far3 плагины от Far 1.xx/2.xx?

A: От Far 1.xx можно, но не рекомендуется, особенно плагины для редактора
   т.к. это может привести к потере данных, от Far 2.xx нет, из-за изменений
   в Far API в Far3 эти плагины не работают, а их подключение через Far3Wrap
   приведёт к непредсказуемым последствиям т.к. проект практически закрыт и
   сегодня во многом не совместим с новым Far API, да и они скорее всего не
   будут работать с Far API b4353.

Q: Можно ли добавить в сборку свои плагины для Far3?

A: Да, можно, но для Far 3.0 b2927 и новее, более старые с высокой долей
   вероятности вызовут проблемы совместимости. Понятно, что настраивать
   их вы должны самостоятельно.

Q: Я добавил плагин как мне его обновить?

A: Плагины скрипты не входящие в сборку пользователь обновляет сам,
   но плагины должны быть собраны для платформы AMD64 (x64, AMD64, x86_64,
   EMT64). 32-х битные (х86) или IA64, ARM64 (Itanium, ARM) плагины х64 Far
   игнорирует и не запускает.

Q: При запуске на Windows 10 выводится сообщение об ошибке плагина SvcMgr
   (Service Manager) версии 2.2.14.3380 (и ниже). Как поступить?

A: Нажать кнопку ВЫГРУЗИТЬ ПЛАГИН (UNLOAD PLUGIN) и удалить подкаталог
   ./plugins/svcmgr вместе с его содержимым. Появится совместимая с Win10
   версия плагина и проблема исчезнет. Причина кроется в изменениях API
   внесённых в Win10 Микрософт с тем, чтобы сделать значительное число
   приложений "устаревшими" и таким образом заставить пользователей покупать
   новые приложения в магазине Микрософт, естественно со встроенным шпионажем
   за пользователем ради его же блага.:)

Q:  NetBox сбоит, обычно выводится ошибка Access Violation (Нарушение доступа)
    в одной из функций, выгрузить его чаще всего не удаётся т.к. аварийно
    завершается задача самого Far. Что делать и что это вызвало?

A:  Обычно причина в повреждении базы "42E4AEB1-A230-44F4-B33C-F195BB654931.db"
    конфигурации плагина лежащей в подкаталоге "%FARPROFILE%\PluginsData".

    Для восстановления нормальной работы плагина надо выполнить следующие
    операции:

    1) Вызывать панель NetBox (при её вызове обычно ошибок не бывает), на
       пассивной панели выбрать или создать каталог для временного хранения
       файлов сессий (*.netbox).
    2) Выделить нужные вам сессии и скопировать их в этот каталог (F5 или
       перетащить их мышкой).
    3) Нажать F9, Параметры, Параметры плагинов, NetBox и по пунктам
       списать на бумажку значения ваших настроек.
    4) Удалить файл базы настроек NetBox:

       "%FARPROFILE%\PluginsData\42E4AEB1-A230-44F4-B33C-F195BB654931.db"

    5) Снова запустить Far, "F9, Параметры, Параметры плагинов, NetBox"
       и последовательно настроить те параметры NetBox которые отличаются
       от записанных вами в п. 3), после чего закрыть диалог настроек
       NetBox - больше он вам до следующего сбоя или изменения его настроек
       не понадобится, затем нажать "ShiftF9 Enter" для сохранения настроек.
    6) Вызываем панель NetBox, там сейчас пусто и мы увидим предложение
       нажать ShiftF4 для создания нового соединения, но пропустим это, а
       открыв на второй панели каталог где мы сохранили сессии выделим их
       и нажмём F5 для импорта, NetBox спросит подтверждение операции,
       ответим утвердительно и по её завершению на панели NetBox будут
       созданы новые сессии, но нам надо сохранить БД, а потому снова нажимаем
       "ShiftF9, Enter".

   Ремонт закончен, но чтобы в другой раз база не повреждалась если у нас есть
   файл резервной копии настроек Far *.farconfig то, открываем его в редакторе
   находим там фрагмент:

     <plugin guid="42E4AEB1-A230-44F4-B33C-F195BB654931">
        <hierarchicalconfig>
         <key name="42E4AEB1-A230-44F4-B33C-F195BB654931" description="NetBox">
	      ...
          </key>
        </hierarchicalconfig>
      </plugin>

   и удаляем включая всё его содержимое - именно этот XML фрагмент содержит
   настройки NetBox которые повреждаются при экcпорте/импорте БД, что и
   приводит к последующим ошибкам в работа плагина.

Меню пользователя:

Q: Можно ли вызвать пользовательское меню из диалога, редактора, вьюера или
   панели быстрого просмотра?

A: Да, это можно сделать с помощью входящего в сборку скрипта нажав CtrlF2.
   По умолчанию вызов меню из панели быстрого просмотра выключен в скрипте
   %FARHOME%\Profile\Macros\scripts\DEVQ_UserMenu.lua который их и вызывает.
   Для включения меню в быстром просмотре раскомментируйте его макрос удалив
   --[[ до и --]] после него.

Q: Можно ли использовать несколько пользовательских меню одновременно и какое
   имя должно быть у файла меню?

A: Да, можно, а имя файла должно быть FarMenu ибо так задано в скрипте
   управления.

Q: Как называются и где хранятся файлы главного и пользовательских меню?

A: Имена файлов меню должны быть DlgMenu (DlgMnu.ini), EdtMenu (EdtMenu.ini),
   VwrMenu (VwrMenu.ini) или QVMenu (QVMenu.ini). Иные скрипт не примет. Это
   было сделано специально для того чтобы вынести в них из общих меню Far
   инструменты вызываемые только в диалоге, редакторе, вьюере и панели быстрого
   просмотра. Меню для каждой области независимые, сначала вызывается локальное
   меню из текущего каталога (если его нет его можно создать), при повторном
   нажатии CtrlF2 вызывается общее меню из %FARPROFILE%\Menus .

A: Можно ли вызвать из одного пользовательского меню другое?

Q: Да, а почему бы и нет? Ограничения определяются вашими задачами и возможны
   разве только в редакторе, вьюере, диалогах или быстром просмотре. Тогда просто
   откройте %FARHOME%\Profile\Macros\scripts\DEVQ_UserMenu.lua и
   раскомментируйте там макрос "Block F2 in to user menu"  удалив --[[ до и --]]
   после него.

Скрипты и макросы:

Q: Куда надо поместить скрипты пользователя чтобы Far их увидел?

A: Скрипты (.lua/.moon файлы) помещаем в каталог %FARPROFILE%\Macros\scripts ,
   Модули (.lua/*.moon файлы) помещаем в каталог %FARPROFILE%\Macros\modules ,
   также допустимо помещать их во вложенные подкаталоги, например для
   группировки по пакетам. Пример такой группировки - пакет LuaCheck .

Q: Можно ли хранить скрипты вне профиля и если можно, то как их подключить?

A: Да, можно. Для этого можно использовать симлинки кинутые в каталог скриптов
   сборки. Добавочное время вызова скриптов будет примерно равно двойному
   времени ответа сети.

Q: В каком формате записывать надо скрипты чтобы не было ошибок?

A: Все используемые скрипты должны быть записаны в кодировке UTF-8 с
   установленной сигнатурой BOM (признак UNICODE) и форматом перевода строк
   CR/LF (DOS/Windows). Иной формат файла скрипта не допустим и приведёт к
   ошибкам!

Q: По какому принципу задаются имена скриптов в сборке и зачем это сделано?

A: Если вы используете свои скрипты, то сохраните их в другом месте и
   переименуйте по шаблону:

      <Префикс>_<имя скрипта>.lua

   где "Префикс" совпадает с именем макрообласти вызова скрипта, а скриптам
   для вызова плагинов и плагинам-скриптам присвоен особый префикс "Plugin"
   что позволяет их визуально отличить от скриптов для макрообластей. Это
   сделано для упрощения ориентации в наборе скриптов. Если скрипт может
   вызываться из нескольких макрообластей, то его префикс составляется из
   первых букв их названий.

Q: А где можно посмотреть список макросов в сборке?

A: Этот список есть в файле macro.txt который обновляется при необходимости.

Q: Я хочу или уже добавил свой скрипт в сборку. Как его обновлять?

A: Добавленные пользователем скрипты он обновляет сам, и если нужно сам правит
   их код для устранения конфликтов или изменения заданных в них умолчаний.

Q: Keys("Add") в редакторе вставляет нулевой символ. Что делать?

A: Для b5433 и новее замените в макросе Keys("Add"), Keys("Subtract"),
   Keys("Multiply"), Keys("Divide") или Keys("Decimal") на Keys("+"),
   Keys("-"), Keys("*"), Keys("/") или Keys(".") соответсвенно.

Работа с архивами:

Q: Почему arclite не опознаёт запароленный архив?

A: При ошибочном вводе пароля arclite не опознает файл как архив и не откроет
   его.

Q: Можно ли в arclite создать архивы bzip2, gzip, xz для всего каталога?

A: Нет, архиваторы Bzip2, Gzip, xz работают только с отдельными файлами, и
   указание для них каталогов качестве источника данных приводит к ошибке, но
   этого можно избежать если предварительно упаковать каталог в контейнер, к
   примеру tar-ом.

Q: Как избежать повреждения исполняемых файлов при сжатии Bzip2?

A: Это явление встречается на UNIX системах и способ предотвращения потери
   данных хорошо известен - помещаем файлы в каталог, после пакуем каталог tar
   и полученный контейнер (тарбалл) сжимаем Bzip2.

Q: Можно ли подключить к сборке внешние архиваторы и как это сделать?

A: Да, можно. К примеру поддержка FreeArc v0.67 уже встроена в сборку через
   плагин MultiArc и его достаточно просто добавить в %PATH%. Другие архиваторы
   можно подключить через %FARHOME%\Plaugins\multiarc\Formats\custom_user.ini
   или через *.fmt модуль поместив его в %FARHOME%\Plaugins\multiarc\Formats\ .

Q: Мне прислали (надо сделать) файл в формате UUE/XXE. Как и чем?

A: ShiftF1 -> arclite -> в диалоге выбора форматов Прочие и там в меню будут
   UUE/XXE с поддержкой кодирования и декодирования этих форматов.

Q: Поддержка Base64 есть?

A: Поддержки Base64 пока нет, а плагин Base64 от Maximus5 не рабочий и баг
   https://github.com/Maximus5/FarPlugins/issues/3 третий год висит, а пункт
   меню MIME в списке форматов сжатия ArcLite расчитан на работу с форматом
   сообщений электронной почты.

Экран:

Q: При разворачивании окна с нестандартной панелью задач нижний край под неё и
   уходит.Это фича или баг?

A: Нет, это особенность геометрии экрана - изначально все консольные программы
   рассчитаны на окно 80х24 (терминал VT120), а если соотношение сторон
   получается иным то при шрифтах по умолчанию размеры окна выходят чуть больше
   ожидаемых. Ситуация исправляется просто - подбираем размеры шрифта. К примеру
   для окна 1920х1080 и экрана 21" - 24" удобен шрифт Lucida Console, 15.

   С учётом того, что современные ОС работают с различными языками, то лучше
   всего использовать UNICIODE шрифты которые в отличии матричных шрифтов легко
   масштабируются и позволяют отображать символы произвольных языков.

   Для изменения размера шрифта просто зажмите Ctrl на клавиатуре и вращением
   колеса мыши подберите удобный вам шрифт, а после выставьте в свойствах
   ярлыка программы подобранный для используемого разрешения экрана размер
   шрифта.

Q: Как изменить размер рабочего окна программы? Стандартные средства Far этого
   не позволяют. Какие инструменты для этого есть в сборке?

A: Изменить размер окна мы можем в любой момент - нажимаем левую кнопку мыши
   (ЛКМ) в правом нижнем углу окна и меняем его размер. Внизу в середине при
   этом мы увидим текущий размер окна, а ЛКМ + колесо позволяет изменить размеры
   шрифта. Изменения действуют только на текущий сеанс, для их сохранения надо
   исправлять ярлык программы.

Мультимедиа:

Q: Я пытаюсь посмотреть кинофильм через Far, но файл открывается во вьюере...

A: Плагин Review использует установленные в системе кодеки DirectShow например
   FFDShow или LAV Codec, но надо указать системе их использование по
   умолчанию.

Паранойя:

Q: В Far есть встроенные средства сбора телеметрии и шпионажа за пользователем?

A: В Far и собираемых с ним плагинах вставка шпионских функций MS VC++2015
   (и более новых версий компилятора) заблокирована на уровне исходников.

Q: Антивирусы считают плагин FarSniffer трояном/вирусом/шпионом. Что делать?

A: Умеряйте паранойю своих мухобоек. Плагин FarSniffer только читает пакеты
   IPv4 в TCP/IP локальных сетях (LAN) для поиска в них неисправностей. Всё,
   что он прочитал с сетевого интерфейса хранится в ОЗУ и после завершения
   сеанса работы с плагином теряется. И если вы посмотрите дамп любого
   считанного им IPv4 пакета то увидите только расшифровку его TCP и IP
   заголовков (хидеров), а поле Data пакета выводится в шестнадцатеричном
   (RAW) виде. Так что украсть вашу личную информацию или нанести какой иной
   вред этот плагин при всём желании не может. Просто авторам мухобоек нужно
   как-то зарабатывать на жизнь.

Q: На форуме ... умные люди пишут что Far это вирус/троян/вчерашний день ...?

A: Сотрите Far и забудьте о нём ибо вам он явно не нужен.

Q: Меня не устраивают настройки, состав сборки, ... что делать?

A: Стереть и сделать своё, а о моей сборке забыть...